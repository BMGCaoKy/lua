---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Jimmy.
--- DateTime: 2020/1/15 0015 10:57
---
local function checkImageStr(str)
    local cfg = Player.SumRechargeConfig
    if str == "" then
        return ""
    end
    if str and str:find("set:") then
        return str
    end
    if str and cfg and cfg.plugin then
        local path = ResLoader:loadImage(cfg, str)
        return path
    end
    return ""
end

function M:init()
    self.__name = ""
end

function M:onLoad()
    local name = string.gsub(self.__name, ".json", "-")
    self.btnClose = self:child(name .. "Close")
    self.ivImage = self:child(name .. "Image")
    self.awActor = self:child(name .. "Actor")
    self.btnConfirm = self:child(name .. "Confirm")
    self:subscribe(self.btnClose, UIEvent.EventButtonClick, function()
        UI:closeWnd("sum_recharge_result")
    end)
    self:subscribe(self.btnConfirm, UIEvent.EventButtonClick, function()
        UI:closeWnd("sum_recharge_result")
    end)
    self.btnConfirm:SetText(Lang:toText("sum.recharge.result.confirm"))
end

function M:onOpen(config)
    UI:closeWnd("sum_recharge_layout")
    if not config then
        return
    end
    if string.find(config.layoutMainImage, ".actor")  ~= nil then
        self.ivImage:SetVisible(false)
        self.awActor:SetVisible(true)
        self.awActor:SetActor1(config.layoutMainImage, "idle")
    else
        self.ivImage:SetVisible(true)
        self.awActor:SetVisible(false)
        self.ivImage:SetImage(checkImageStr(config.layoutMainImage))
    end
end

function M:reloadUI(config)
    if self.__name ~= config.resultUIName then
        if self._root then
            GUIWindowManager.instance:DestroyGUIWindow(self._root)
        end
        self.__name = config.resultUIName
        WinBase.init(self, config.resultUIName)
        self:onLoad()
    end
end